<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make a Wish</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 100;
        }
    </style>
</head>
<body class="overflow-hidden">

    <canvas id="magicCanvas"></canvas>

    <div class="glass-card rounded-2xl p-8 max-w-md w-full mx-4 text-center transform transition-all relative z-10">
        <h1 class="text-4xl md:text-5xl text-yellow-100 mb-2 font-['Dancing_Script'] drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]">
            Make a Wish
        </h1>
        <p class="text-blue-100 font-['Quicksand'] text-sm mb-6 opacity-90">
            Whisper your dreams to the stars...
        </p>

        <form id="wishForm" class="space-y-4">
            <div class="relative">
                <textarea 
                    name="wish"
                    id="wishInput"
                    required
                    class="wish-input w-full h-32 bg-white/10 border border-white/20 rounded-xl p-4 text-white font-['Quicksand'] text-lg focus:outline-none focus:ring-2 focus:ring-yellow-200/50 resize-none transition-all"
                    placeholder="I wish for..."
                ></textarea>
                <div class="absolute top-2 right-2 text-yellow-200 text-xl star-decoration">âœ¨</div>
            </div>

            <button type="submit" id="sendBtn" class="magic-btn w-full py-3 rounded-full text-white font-bold font-['Quicksand'] text-lg tracking-wide shadow-lg flex items-center justify-center gap-2 group relative overflow-hidden">
                <span id="btnText">Send to the Stars</span>
            </button>
        </form>
    </div>

    <script>
        const canvas = document.getElementById('magicCanvas');
        const ctx = canvas.getContext('2d');
        const wishForm = document.getElementById('wishForm');
        const btnText = document.getElementById('btnText');
        const sendBtn = document.getElementById('sendBtn');

        let particles = [];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 3 + 1;
                this.speedX = Math.random() * 6 - 3;
                this.speedY = Math.random() * -10 - 2; // Move upwards
                this.color = `hsl(${Math.random() * 60 + 40}, 100%, 70%)`; // Gold/Yellow sparks
                this.opacity = 1;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.opacity -= 0.01;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.opacity;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].opacity <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animate);
        }
        animate();

        wishForm.addEventListener("submit", function(event) {
            event.preventDefault();
            
            // 1. Trigger Particle Blast
            const rect = sendBtn.getBoundingClientRect();
            for(let i=0; i<50; i++) {
                particles.push(new Particle(rect.left + rect.width/2, rect.top));
            }

            btnText.innerText = "Sending Magic...";
            sendBtn.disabled = true;

            // 2. Send to Formspree
            fetch("https://formspree.io/f/xpwvvppz", {
                method: "POST",
                body: new FormData(event.target),
                headers: { 'Accept': 'application/json' }
            }).then(response => {
                if (response.ok) {
                    btnText.innerText = "Wish Received! ðŸŒŸ";
                    setTimeout(() => {
                        window.location.reload(); 
                    }, 2000);
                } else {
                    alert("The magic failed. Try again.");
                    btnText.innerText = "Send to the Stars";
                    sendBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>